"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const agent_context_1 = __importDefault(require("../../context/agent-context"));
const collection_decorator_1 = __importDefault(require("../collection-decorator"));
const datasource_decorator_1 = __importDefault(require("../datasource-decorator"));
const result_builder_1 = __importDefault(require("./result-builder"));
class ChartDataSourceDecorator extends datasource_decorator_1.default {
    constructor(childDataSource) {
        super(childDataSource, collection_decorator_1.default);
        this.charts = {};
    }
    get schema() {
        return {
            ...this.childDataSource.schema,
            charts: [...this.childDataSource.schema.charts, ...Object.keys(this.charts)],
        };
    }
    addChart(name, definition) {
        this.charts[name] = definition;
    }
    async renderChart(caller, name) {
        if (!this.charts[name]) {
            return super.renderChart(caller, name);
        }
        return this.charts[name](new agent_context_1.default(this, caller), new result_builder_1.default());
    }
}
exports.default = ChartDataSourceDecorator;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YXNvdXJjZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9kZWNvcmF0b3JzL2NoYXJ0L2RhdGFzb3VyY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFLQSxnRkFBb0U7QUFDcEUsbUZBQTBEO0FBQzFELG1GQUEwRDtBQUMxRCxzRUFBNkM7QUFFN0MsTUFBcUIsd0JBQXlCLFNBQVEsOEJBQW1CO0lBVXZFLFlBQVksZUFBMkI7UUFDckMsS0FBSyxDQUFDLGVBQWUsRUFBRSw4QkFBbUIsQ0FBQyxDQUFDO1FBVnRDLFdBQU0sR0FBb0MsRUFBRSxDQUFDO0lBV3JELENBQUM7SUFURCxJQUFhLE1BQU07UUFDakIsT0FBTztZQUNMLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNO1lBQzlCLE1BQU0sRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7U0FDN0UsQ0FBQztJQUNKLENBQUM7SUFNRCxRQUFRLENBQUMsSUFBWSxFQUFFLFVBQTJCO1FBQ2hELElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsVUFBVSxDQUFDO0lBQ2pDLENBQUM7SUFFUSxLQUFLLENBQUMsV0FBVyxDQUFDLE1BQWMsRUFBRSxJQUFZO1FBQ3JELElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFO1lBQ3RCLE9BQU8sS0FBSyxDQUFDLFdBQVcsQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7U0FDeEM7UUFFRCxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSx1QkFBeUIsQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLEVBQUUsSUFBSSx3QkFBYSxFQUFFLENBQUMsQ0FBQztJQUM3RixDQUFDO0NBQ0Y7QUF6QkQsMkNBeUJDIn0=